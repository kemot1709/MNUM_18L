function [x,x1,x2]=Adams(q1,q2,h)
h2=h/2;
x(n)=0;
x1(1)=q1;
x2(1)=q2;
x1h(1)=q1;
x2h(1)=q2;
beta=[55/24,-59/24,37/24,-9/24];
betag=[251/720,646/720,-264/720,106/720,-19/720];

for n = 1:3
k11=x2(n)+x1(n)*(0.2-x1(n)^2-x2(n)^2);
k12=-x1(n)+x2(n)*(0.2-x1(n)^2-x2(n)^2);
k21=(x2(n)+h*k12/2)+(x1(n)+h*k11/2)*(0.2-(x1(n)+h*k11/2)^2-(x2(n)+h*k12/2)^2);
k22=-(x1(n)+h*k11/2)+(x2(n)+h*k12/2)*(0.2-(x1(n)+h*k11/2)^2-(x2(n)+h*k12/2)^2);
k31=(x2(n)+h*k22/2)+(x1(n)+h*k21/2)*(0.2-(x1(n)+h*k21/2)^2-(x2(n)+h*k22/2)^2);
k32=-(x1(n)+h*k21/2)+(x2(n)+h*k22/2)*(0.2-(x1(n)+h*k21/2)^2-(x2(n)+h*k22/2)^2);
k41=(x2(n)+h*k32)+(x1(n)+h*k31)*(0.2-(x1(n)+h*k31)^2-(x2(n)+h*k32)^2);
k42=-(x1(n)+h*k32)+(x2(n)+h*k31)*(0.2-(x1(n)+h*k31)^2-(x2(n)+h*k32)^2);

x1(n+1) = x1(n) + (1/6)*h*(k11 + 2*k21 + 2*k31 + k41);
x2(n+1) = x2(n) + (1/6)*h*(k12 + 2*k22 + 2*k32 + k42);
x11(1) = x1h(n);
x21(1) = x2h(n);
for j = 1:2
    k11=x21(j)+x11(j)*(0.2-x11(j)^2-x21(j)^2);
    k12=-x11(j)+x21(j)*(0.2-x11(j)^2-x21(j)^2);
    k21=(x21(j)+h*k12/4)+(x11(j)+h*k11/4)*(0.2-(x11(j)+h*k11/4)^2-(x21(j)+h*k12/4)^2);
    k22=-(x11(j)+h*k11/4)+(x21(j)+h*k12/4)*(0.2-(x11(j)+h*k11/4)^2-(x21(j)+h*k12/4)^2);
    k31=(x21(j)+h*k22/4)+(x11(j)+h*k21/4)*(0.2-(x11(j)+h*k21/4)^2-(x21(j)+h*k22/4)^2);
    k32=-(x11(j)+h*k21/4)+(x21(j)+h*k22/4)*(0.2-(x11(j)+h*k21/4)^2-(x21(j)+h*k22/4)^2);
    k41=(x21(j)+h*k32/2)+(x11(j)+h*k31/2)*(0.2-(x11(j)+h*k31/4)^2-(x21(j)+h*k32/4)^2);
    k42=-(x11(j)+h*k32/2)+(x21(j)+h*k31/2)*(0.2-(x11(j)+h*k31/4)^2-(x21(j)+h*k32/4)^2);
    x11(j+1)=x11(j)+h*(k11+2*k21+2*k31+k41)/12;
    x21(j+1)=x21(j)+h*(k12+2*k22+2*k32+k42)/12;
end
x1h(n+1)=x11(3);
x2h(n+1)=x21(3);
end
err1 =(16/15) * abs(x1h - x1);
err2 =(16/15) * abs(x2h - x2);
for n=5:(podzial+1)
suma1 = 0;
suma2 = 0;
for j =1:4
suma1 = suma1 + beta(j)*p1(x1(n-j), x2(n-j));
suma2 = suma2 + beta(j)*p2(x1(n-j), x2(n-j));
end
x10 = x1(n-1) + h*suma1;
x20 = x2(n-1) + h*suma2;
f1 = p1(x10,x20);
f2 = p2(x10,x20);
suma1 = 0;
suma2 = 0;
for j =1:3
suma1 = suma1 + betag(j+1)*p1(x1(n-j), x2(n-j));
suma2 = suma2 + betag(j+1)*p2(x1(n-j), x2(n-j));
end
x1(n) = x1(n-1) + h*suma1 + h*betag(1)*f1;
x2(n) = x2(n-1) + h*suma2 + h*betag(1)*f2;
err1(n) = -(19/270)*(x10 - x1(n));
err2(n) = -(19/270)*(x20 - x2(n));
end
end